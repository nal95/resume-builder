<div *ngIf="(userWorkExperiences$ | async) as workExperiences">
  <ng-container *ngFor="let workExperience of workExperiences">
    <div class="card m-2">
      <header class="card-header">
        <p class="card-header-title">{{ workExperience.company }}</p>
        <button class="card-header-icon" aria-label="more options" (click)="deleteWorkExperience(workExperience)">
          <span class="icon">
            <i class="ri-close-line" aria-hidden="true"></i>
          </span>
        </button>
        <button class="card-header-icon" aria-label="more options" (click)="toggleWorkExperience(workExperience)">
          <span class="icon">
            <i class="ri-arrow-down-s-line" aria-hidden="true" *ngIf="workExperience.showContent===false"></i>
            <i class="ri-arrow-up-s-line" aria-hidden="true" *ngIf="workExperience.showContent===true"></i>
          </span>
        </button>
      </header>
      <div class="card-content m-0 p-2" [ngClass]="{ 'is-hidden': workExperience.showContent===false }">
        <app-input-with-icon-text [label]="'Company'"
                                  [placeholder]="'e.g Company XYZ'"
                                  name="company"
                                  ngDefaultControl
                                  type="text"
                                  [inputValue]="workExperience.company"
                                  [(ngModel)]="workExperience.company">
        </app-input-with-icon-text>
        <app-input-with-icon-text [label]="'Position'"
                                  [placeholder]="'e.g Software Developer'"
                                  name="position"
                                  ngDefaultControl
                                  type="text"
                                  [inputValue]="workExperience.occupiedPosition"
                                  [(ngModel)]="workExperience.occupiedPosition">
        </app-input-with-icon-text>
        <app-input-with-icon-text [label]="'Year'"
                                  [placeholder]="'4 Year'"
                                  name="duration"
                                  ngDefaultControl
                                  type="number"
                                  [inputValue]="workExperience.duration"
                                  [(ngModel)]="workExperience.duration">
        </app-input-with-icon-text>
        <app-input-with-icon-text [label]="'Location'"
                                  [placeholder]="'Company Location'"
                                  name="location"
                                  ngDefaultControl
                                  type="text"
                                  [inputValue]="workExperience.companyCity"
                                  [(ngModel)]="workExperience.companyCity">
        </app-input-with-icon-text>
        <app-input-with-icon-text [label]="'Home Page'"
                                  [placeholder]="'Company Home Page'"
                                  name="companyLink"
                                  ngDefaultControl
                                  type="url"
                                  [inputValue]="workExperience.companyLink"
                                  [(ngModel)]="workExperience.companyLink">
        </app-input-with-icon-text>
        <app-input-with-icon-text [label]="'Start'"
                                  [placeholder]="'Start Date'"
                                  name="startDate"
                                  ngDefaultControl
                                  type="month"
                                  [inputValue]="workExperience.startDate"
                                  [(ngModel)]="workExperience.startDate">
        </app-input-with-icon-text>

        <app-input-with-icon-text *ngIf="!workExperience.actual; else actual"
                                  [label]="'End'"
                                  [placeholder]="'End Date'"
                                  name="endDate"
                                  ngDefaultControl
                                  type="month"
                                  [inputValue]="workExperience.endDate"
                                  [(ngModel)]="workExperience.endDate">
        </app-input-with-icon-text>

        <button class="button is-small is-ghost" *ngIf="!workExperience.actual"
                (click)="makeDateActual(workExperience)">
          <p class="is-text is-small">Still work by <strong> {{ workExperience.company }} ?</strong></p>
        </button>

        <div class="field">
          <div class="field-body m-1 p-1 is-grouped">
            <div class="field">
              <label class="label is-small">Few points from your experience:</label>
              <div class="control">
                <app-quill (textChanged)="onSummaryChanged(workExperience,$event)"
                           [text]="workExperience.summary"></app-quill>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>

<ng-template #actual>
  <app-input-with-icon-text [label]="'Actual'"
                            [placeholder]="'End Date'"
                            name="endDate"
                            ngDefaultControl
                            type="text"
                            [inputValue]="'Present'">
  </app-input-with-icon-text>
</ng-template>
<div class="field m-1 p-2 is-flex is-justify-content-center">
  <button class="button is-small is-primary is-light is-rounded is-focused" type="submit" (click)="addWorkExperience()">
    <span class="icon is-small">
      <i class="ri-add-box-fill"></i>
    </span>
    <span>Add</span>
  </button>
</div>
